{{define "title"}}{{if .Feed}}{{.Feed.Name}}{{else}}Feeds{{end}}{{end}}
{{template "head" .}}
<p class="header"><a href="/">Mochi</a>{{if .User}} | <a href="/feeds">Feeds</a>{{end}}{{if .Feed}} | {{.Feed.Name}}{{end}}</p>

<style>.off { filter: grayscale(100%); }</style>

{{if .User}}
<p><a href="/feeds/find">Subscribe to a feed</a>{{if .Feed}}{{if not .Feed.Owner}} | <a href="/feeds/{{.Feed.fingerprint}}/unsubscribe">Unsubscribe from {{.Feed.Name}}</a>{{end}}{{end}} | <a href="/feeds/new">Create new feed</a>{{if .Owner}} | <a href="/feeds/post/new{{if .Feed}}?current={{.Feed.ID}}{{end}}">New post</a>{{end}}<br/>
<a href="/feeds">All feeds</a>{{range .Feeds}} | <a href="/feeds/{{.fingerprint}}">{{.name}}</a>{{end}}</p>
{{end}}

<div style="background: #dddddd; padding: 2px;">

{{range .Posts}}
<a href="/feeds/{{.FeedFingerprint}}/{{.ID}}" style="text-decoration:none;"><div style="background: white; margin: 10px; padding: 5px; border-radius: 5px; box-shadow: 1px 1px;">
{{.BodyMarkdown}}

{{template "attachments" .}}

{{if $.User}}
<p style="font-variant: small-caps;">{{if not $.Feed}}{{.FeedName}}, {{end}}{{.CreatedString}} | <a href="/feeds/{{.Feed}}/{{.ID}}/comment">New comment</a>&nbsp;
{{if ne .MyReaction ""}}<a href="/feeds/{{.FeedFingerprint}}/{{.ID}}/react/none" title="None" class="off">&#128528;</a> {{end}}<a href="/feeds/{{.FeedFingerprint}}/{{.ID}}/react/like" title="Like" {{if ne .MyReaction "like"}}class="off"{{end}}>&#128515;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.ID}}/react/dislike" title="Dislike" {{if ne .MyReaction "dislike"}}class="off"{{end}}>&#128543;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.ID}}/react/laugh" title="Laugh" {{if ne .MyReaction "laugh"}}class="off"{{end}}>&#128541;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.ID}}/react/amazed" title="Amazed" {{if ne .MyReaction "amazed"}}class="off"{{end}}>&#128562;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.ID}}/react/love" title="Love" {{if ne .MyReaction "love"}}class="off"{{end}}>&#128536;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.ID}}/react/sad" title="Sad" {{if ne .MyReaction "sad"}}class="off"{{end}}>&#128542;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.ID}}/react/angry" title="Angry" {{if ne .MyReaction "angry"}}class="off"{{end}}>&#128544;</a><a href="/feeds/{{.FeedFingerprint}}/{{.ID}}/react/agree" title="Agree" {{if ne .MyReaction "agree"}}class="off"{{end}}>&#128077;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.ID}}/react/disagree" title="Disagree" {{if ne .MyReaction "disagree"}}class="off"{{end}}>&#128078;</a>&nbsp;
{{end}}
{{range .Reactions}} | {{.Name}} {{if eq .Reaction "like"}}&#128515;{{end}}{{if eq .Reaction "dislike"}}&#128543;{{end}}{{if eq .Reaction "laugh"}}&#128541;{{end}}{{if eq .Reaction "amazed"}}&#128562;{{end}}{{if eq .Reaction "love"}}&#128536;{{end}}{{if eq .Reaction "sad"}}&#128542;{{end}}{{if eq .Reaction "angry"}}&#128544;{{end}}{{if eq .Reaction "agree"}}&#128077;{{end}}{{if eq .Reaction "disagree"}}&#128078;{{end}}{{end}}</p>

<p>{{range .Comments}}{{template "feed_comment" .}}{{end}}</p>

</div></a>
{{end}}

</div>
{{template "foot" .}}

{{define "feed_comment"}}
	<div style="border-left: 2px solid blue; padding-left: 10px;">
    {{.BodyMarkdown}}
	<p style="font-variant: small-caps;">{{.Name}} {{.CreatedString}}{{if .User}} <a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/comment?parent={{.ID}}">Reply</a>&nbsp;
    {{if ne .MyReaction ""}}<a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/{{.ID}}/react/none" title="None" class="off">&#128528;</a> {{end}}<a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/{{.ID}}/react/like" title="Like" {{if ne .MyReaction "like"}}class="off"{{end}}>&#128515;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/{{.ID}}/react/dislike" title="Dislike" {{if ne .MyReaction "dislike"}}class="off"{{end}}>&#128543;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/{{.ID}}/react/laugh" title="Laugh" {{if ne .MyReaction "laugh"}}class="off"{{end}}>&#128541;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/{{.ID}}/react/amazed" title="Amazed" {{if ne .MyReaction "amazed"}}class="off"{{end}}>&#128562;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/{{.ID}}/react/love" title="Love" {{if ne .MyReaction "love"}}class="off"{{end}}>&#128536;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/{{.ID}}/react/sad" title="Sad" {{if ne .MyReaction "sad"}}class="off"{{end}}>&#128542;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/{{.ID}}/react/angry" title="Angry" {{if ne .MyReaction "angry"}}class="off"{{end}}>&#128544;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/{{.ID}}/react/agree" title="Agree" {{if ne .MyReaction "agree"}}class="off"{{end}}>&#128077;</a> <a href="/feeds/{{.FeedFingerprint}}/{{.Post}}/{{.ID}}/react/disagree" title="Disagree" {{if ne .MyReaction "disagree"}}class="off"{{end}}>&#128078;</a>&nbsp;
	{{end}}
    {{range .Reactions}} | {{.Name}} {{if eq .Reaction "like"}}&#128515;{{end}}{{if eq .Reaction "dislike"}}&#128543;{{end}}{{if eq .Reaction "laugh"}}&#128541;{{end}}{{if eq .Reaction "amazed"}}&#128562;{{end}}{{if eq .Reaction "love"}}&#128536;{{end}}{{if eq .Reaction "sad"}}&#128542;{{end}}{{if eq .Reaction "angry"}}&#128544;{{end}}{{if eq .Reaction "agree"}}&#128077;{{end}}{{if eq .Reaction "disagree"}}&#128078;{{end}}{{end}}
    </p>
    {{range .Children}}{{template "feed_comment" .}}{{end}}
	</div>
{{end}}
